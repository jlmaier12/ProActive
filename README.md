# ProActive
Active prophage detection in metagenome sequencing read coverages

### Decription
ProActive detects regions of elevated read coverage representative of active propgages in sequencing reads mapped to metagenome contigs. When a prophage activates and enters the lytic cycle, its genome begins replicating and the ratio of bacterial:phage genome in the cell begins to decrease. Because there are more phage genomes than bacterial genomes, the phage genome is overrepresented during sequencing and more reads are generated for the phage than the bacteria. When reads are mapped back to the contigs, the phage reads will map to its prophage location within the bacterial genome and due to the overabundance of phage reads, the prophage region read coverage will be elevated in comparison to the read coverage of the bacterial genome on either side of the prophage. The increase in read coverage at prophage locations can be detected and inferences can be made about the lytic activity of the associated phage. However, in order to assess variations in read coverage between the phage and bacterial genomes, the genomic coordinates of the prophages must be known. Genomic locations of prophages are usually idenfitied, at least in part, using phage-related gene annotations. Relying on gene annotations for prophage detection means that only annotated phage are detcted while the vast majority are missed. ProActive, however, is reference-independent and therefore bypasses this barier to active prophage identification.

ProActive works by detecting the 'shape' created by the read coverages of an active prophage. When the read coverages for an active prophage are plotted as a bar graph, the elevated read coverage at the prophage location creates a 'block-like' shape. ProActive scans through all the contigs in a metagenome and searches each one for a 'block-like' shape with a base pair size that is realistic for that of a phage genome. ProActive will output a summary table containing all the conitgs with a potentially active prophage, the sizes of the active prophages, and bar graphs visualizing the active prophage read coverage with the shape that ProActive used to make its final identification. As an optional feature, users may input a PROKKA gff file containing gene annotations for their contigs which ProActive will use to determine which of the identified active prophages have phage-related gene annotations. 

To be clear, while ProActive labels the elevated read coverage it detcts as active prophage, there are other circumstances that can create read coverage patterns similar to that of active prophage. For example, chimeric assemblies can create contigs with regions of elevated read coverage that are not associated with active prophage, but ProActive will likely identify this type of event as an active prophage. It is up to the user to assess the active prophage identifications and check for false positives. Typically, there tendd to be more false positive identifications made in short, low-quality contigs. 
